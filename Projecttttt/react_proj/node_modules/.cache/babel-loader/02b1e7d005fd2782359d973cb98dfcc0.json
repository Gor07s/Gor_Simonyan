{"ast":null,"code":"var _jsxFileName = \"/home/gor/Project/Email_tamplate/react_proj/src/Components/sendTemplate.js\";\nimport React, { Component } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass SendTemplate extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      show: props.show,\n      variables: {},\n      template: props.template[0],\n      txt: props.template[0].templateText,\n      text: props.template[0].templateText,\n      recipients: props.recipients,\n      recCount: 1\n    };\n    this.wordsForCheck = [];\n    this.arr = [];\n    this.vars = props.vars;\n    this.varsIndividual = {};\n    this.UseTemplateFunc = this.UseTemplateFunc.bind(this);\n    this.sendMail = this.sendMail.bind(this);\n    this.textGenerator = this.textGenerator.bind(this);\n    this.wordFinder = this.wordFinder.bind(this);\n    this.addRecipient = this.addRecipient.bind(this);\n    this.check = this.check.bind(this);\n  }\n\n  componentDidMount() {\n    if (this.state.show) {\n      this.UseTemplateFunc();\n      this.setState({\n        show: false\n      });\n    }\n  }\n\n  componentDidUpdate(prevProps, prevState, snapshot) {\n    if (this.state.show) {\n      this.UseTemplateFunc();\n      this.setState({\n        show: false\n      });\n    }\n  }\n\n  wordFinder(word) {\n    let start = null;\n    let st = 0;\n\n    if (word.includes(\"{\") && word.includes(\"}\")) {\n      for (let i = 0; i < word.length; i++) {\n        if (word[0] !== \"{\") {\n          this.wordsForCheck.forEach(element => {\n            if (this.state.variables[element] === \"\") {\n              this.arr.push(\"{\" + element + \"}\");\n            } else {\n              this.arr.push(this.state.variables[element]);\n            }\n          });\n          this.wordsForCheck = [];\n        }\n\n        if (word[i] === \"{\") {\n          start = i;\n\n          if (st !== null) {\n            this.arr.push(word.replace(word.slice(i, word.length), \"\"));\n            word = word.replace(word.slice(st, i), \"\");\n            st = null;\n\n            if (start !== null) {\n              start = 0;\n            }\n          }\n        } else if (word[i] === \"}\") {\n          if (start !== null) {\n            if (this.state.variables[word.slice(start + 1, i)] !== undefined) {\n              this.wordsForCheck.splice(0, 0, word.slice(start + 1, i));\n            }\n\n            let newWord = word.replace(word.slice(start, i + 1), \"\");\n            this.wordFinder(newWord);\n            return;\n          }\n        }\n      }\n    } else {\n      this.wordsForCheck.forEach(element => {\n        if (this.state.variables[element] === \"\") {\n          this.arr.push(\"{\" + element + \"}\");\n        } else {\n          this.arr.push(this.state.variables[element]);\n        }\n      });\n      this.wordsForCheck = [];\n      this.arr.push(word);\n    }\n  }\n\n  textGenerator() {\n    const text = this.state.txt.split(\" \");\n\n    for (let i = 1; i <= text.length; i += 2) {\n      text.splice(i, 0, \" \");\n    }\n\n    text.forEach(word => {\n      this.wordFinder(word, []);\n    });\n  }\n\n  check(checkbox, variable) {\n    if (checkbox.checked) {\n      const div = document.getElementById(\"d\" + checkbox.id);\n\n      for (let i = 2; i <= this.state.recCount; i++) {\n        if (!document.getElementById(\"v\" + checkbox.id + \"dv\" + i)) {\n          const label = document.createElement(\"label\");\n          const input = document.createElement(\"input\");\n          const newDiv = document.createElement(\"div\");\n          input.id = \"t\" + checkbox.id + \"_\" + i;\n\n          input.onchange = e => {\n            this.varsIndividual[variable][i - 1] = e.target.value || \"{\" + variable + \"}\";\n          };\n\n          label.innerHTML = variable;\n          label.htmlFor = \"t\" + checkbox.id + \"_\" + i;\n          newDiv.id = \"v\" + checkbox.id + \"dv\" + i;\n          newDiv.appendChild(label);\n          newDiv.appendChild(input);\n          div.appendChild(newDiv);\n        }\n      }\n\n      const extraDiv = document.getElementById(\"v\" + checkbox.id + \"dv\" + (this.state.recCount + 1));\n      if (extraDiv) extraDiv.parentNode.removeChild(extraDiv);\n    } else {\n      for (let i = 2; i <= this.state.recCount; i++) {\n        const div = document.getElementById(\"v\" + checkbox.id + \"dv\" + i);\n        if (div) div.parentNode.removeChild(div);\n      }\n\n      this.varsIndividual[variable] = [this.varsIndividual[variable][0]];\n    }\n\n    console.log(this.varsIndividual);\n  }\n\n  async UseTemplateFunc() {\n    const div = document.getElementById(\"forVars\");\n    await this.vars.forEach(v => {\n      const copy = Object.assign(this.state.variables, {\n        [v.varName]: \"{\" + [v.varName] + \"}\"\n      });\n      const copy2 = Object.assign(this.varsIndividual, {\n        [v.varName]: [\"{\" + [v.varName] + \"}\"]\n      });\n      this.varsIndividual = copy2;\n      this.setState({\n        variables: copy\n      });\n    });\n    await this.vars.forEach((template, index) => {\n      div.style.borderStyle = \"groove\";\n      div.style.borderColor = \"black\";\n      div.style.paddingTop = \"10px\";\n      div.style.paddingBottom = \"10px\";\n      div.style.paddingLeft = \"10px\";\n      const label = document.createElement(\"label\");\n      const input = document.createElement(\"input\");\n      const newDiv = document.createElement(\"div\");\n      const check = document.createElement(\"input\");\n      newDiv.id = \"d\" + (index + 1);\n      newDiv.className = \"checkDivs\";\n      check.className = \"checkbox\";\n      check.type = \"checkbox\";\n      check.id = index + 1;\n      input.id = \"t\" + (index + 1);\n\n      input.onchange = e => {\n        this.setState(prevState => ({\n          variables: { ...prevState.variables,\n            [template.varName]: e.target.value\n          }\n        }));\n        this.varsIndividual[template.varName][0] = e.target.value || \"{\" + template.varName + \"}\";\n        this.textGenerator();\n        let txt = \"\";\n        this.arr.forEach(v => txt += v);\n        this.arr = [];\n        this.setState({\n          text: txt\n        });\n      };\n\n      label.innerHTML = template.varName || \"{noname}\";\n      label.htmlFor = \"t\" + (index + 1);\n\n      check.onclick = e => this.check(e.target, label.innerHTML);\n\n      newDiv.appendChild(label);\n      newDiv.appendChild(input);\n      newDiv.appendChild(check);\n      div.appendChild(newDiv);\n    });\n    const div2 = document.getElementById(\"addRecBigDiv\");\n    await this.state.recipients.forEach((rec, index) => {\n      if (index !== 0) {\n        const input = document.createElement(\"input\");\n        const button = document.createElement(\"button\");\n        const div = document.createElement(\"div\");\n        input.value = rec;\n        div.className = \"addRecDiv\";\n        div.style.display = \"flex\";\n        this.setState({\n          recCount: this.state.recCount + 1\n        });\n        input.id = \"to\" + this.state.recCount;\n        button.innerHTML = \"X\";\n        input.style.display = \"flex\";\n        input.className = \"formInputRec\";\n        button.className = \"delButRec\";\n        button.type = \"button\";\n\n        button.onclick = () => {\n          input.parentNode.removeChild(input);\n          button.style.display = \"none\";\n        };\n\n        div.appendChild(input);\n        div.appendChild(button);\n        div2.appendChild(div);\n      }\n    });\n  }\n\n  async sendMail() {\n    const from = document.getElementById(\"from\").value;\n    let to = \"\";\n\n    for (let i = 1; i <= this.state.recCount; i++) {\n      const rec = document.getElementById(\"to\" + i).value;\n      to += rec;\n\n      if (i !== this.state.recCount) {\n        to += \",\";\n      }\n    }\n\n    const title = document.getElementById(\"title\").value;\n    const text = document.getElementById(\"text\").value;\n    await fetch(\"/useTemplate/send\", {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        user: \"gorsimonyan200307@gmail.com\",\n        pass: \"gor07072003\",\n        from: from,\n        to: to,\n        subject: title,\n        text: text\n      })\n    }).then(res => res.text()).then(res => this.setState({\n      apiResponse: res\n    }));\n  }\n\n  async addRecipient() {\n    const input = document.createElement(\"input\");\n    const delButton = document.createElement(\"button\");\n    const div = document.createElement(\"div\");\n    await this.setState({\n      recCount: this.state.recCount + 1\n    });\n\n    for (let i = 1; i <= this.vars.length; i++) {\n      const checkbox = document.getElementById(i);\n      this.check(checkbox, Object.keys(this.varsIndividual)[i - 1]);\n    }\n\n    div.style.display = \"flex\";\n    div.className = \"addRecDiv\";\n    input.id = \"recipients\" + this.state.recCount;\n    input.style.display = \"flex\";\n    input.className = \"formInputRec\";\n    delButton.className = \"delButRec\";\n    delButton.type = \"button\";\n    delButton.id = \"del\" + this.state.recCount;\n    delButton.innerHTML = \"X\";\n\n    delButton.onclick = async () => {\n      input.parentNode.removeChild(input);\n      delButton.style.display = \"none\";\n      await this.setState({\n        recCount: this.state.recCount - 1\n      });\n\n      for (let i = 1; i <= this.vars.length; i++) {\n        const checkbox = document.getElementById(i);\n        this.check(checkbox, Object.keys(this.varsIndividual)[0]);\n      }\n    };\n\n    const bigDiv = document.getElementById(\"addRecBigDiv\");\n    div.appendChild(input);\n    div.appendChild(delButton);\n    bigDiv.appendChild(div);\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        \"width\": \"100%\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(Link, {\n        to: \"/\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          id: \"back\",\n          children: \"Back\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 277,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 276,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"sendBox\",\n        children: /*#__PURE__*/_jsxDEV(\"form\", {\n          id: \"sendForm\",\n          onSubmit: e => {\n            e.preventDefault();\n            window.history.replaceState(null, '', \"/\");\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"from\",\n              className: \"form\",\n              children: \"from\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 285,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              id: \"from\",\n              type: \"email\",\n              className: \"form\",\n              value: this.state.template.templateFrom,\n              onChange: e => {\n                this.setState(prevState => ({\n                  template: { ...prevState.template,\n                    templateFrom: e.target.value\n                  }\n                }));\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 286,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 284,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"to\",\n              className: \"form\",\n              children: \"To\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 294,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              id: \"to1\",\n              type: \"email\",\n              className: \"form\",\n              value: this.state.recipients[0],\n              onChange: e => {\n                this.setState(prevState => ({\n                  recipients: { ...prevState.recipients,\n                    [0]: e.target.value\n                  }\n                }));\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 295,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              id: \"addRec\",\n              onClick: () => this.addRecipient(),\n              children: \"Add Recipient\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 301,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 293,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            id: \"addRecBigDiv\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 303,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              id: \"titleLabel\",\n              htmlFor: \"title\",\n              className: \"form\",\n              children: \"title\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 307,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              id: \"title\",\n              className: \"form\",\n              value: this.state.template.templateTitle,\n              onChange: e => {\n                this.setState(prevState => ({\n                  template: { ...prevState.template,\n                    templateTitle: e.target.value\n                  }\n                }));\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 308,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 306,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            id: \"forVars\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 315,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"text\",\n              className: \"form\",\n              id: \"textLabel\",\n              children: \"Text\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 319,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n              id: \"text\",\n              value: this.state.text,\n              className: \"form\",\n              onChange: e => this.setState({\n                text: e.target.value,\n                txt: e.target.value\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 320,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 318,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Link, {\n            to: \"/\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              id: \"submit\",\n              type: \"submit\",\n              className: \"form\",\n              onClick: this.sendMail,\n              children: \"Send\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 323,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 322,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 280,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 279,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 275,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default SendTemplate;","map":{"version":3,"sources":["/home/gor/Project/Email_tamplate/react_proj/src/Components/sendTemplate.js"],"names":["React","Component","Link","SendTemplate","constructor","props","state","show","variables","template","txt","templateText","text","recipients","recCount","wordsForCheck","arr","vars","varsIndividual","UseTemplateFunc","bind","sendMail","textGenerator","wordFinder","addRecipient","check","componentDidMount","setState","componentDidUpdate","prevProps","prevState","snapshot","word","start","st","includes","i","length","forEach","element","push","replace","slice","undefined","splice","newWord","split","checkbox","variable","checked","div","document","getElementById","id","label","createElement","input","newDiv","onchange","e","target","value","innerHTML","htmlFor","appendChild","extraDiv","parentNode","removeChild","console","log","v","copy","Object","assign","varName","copy2","index","style","borderStyle","borderColor","paddingTop","paddingBottom","paddingLeft","className","type","onclick","div2","rec","button","display","from","to","title","fetch","method","headers","body","JSON","stringify","user","pass","subject","then","res","apiResponse","delButton","keys","bigDiv","render","preventDefault","window","history","replaceState","templateFrom","templateTitle"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\"\nimport {Link} from \"react-router-dom\";\n\nclass SendTemplate extends Component{\n    constructor(props) {\n        super(props);\n        this.state={\n            show: props.show,\n            variables: {},\n            template: props.template[0],\n            txt : props.template[0].templateText,\n            text: props.template[0].templateText,\n            recipients : props.recipients,\n            recCount: 1,\n        }\n        this.wordsForCheck = []\n        this.arr = []\n        this.vars = props.vars\n        this.varsIndividual = {}\n        this.UseTemplateFunc = this.UseTemplateFunc.bind(this)\n        this.sendMail = this.sendMail.bind(this)\n        this.textGenerator = this.textGenerator.bind(this)\n        this.wordFinder = this.wordFinder.bind(this)\n        this.addRecipient = this.addRecipient.bind(this)\n        this.check = this.check.bind(this)\n    }\n\n    componentDidMount() {\n        if(this.state.show){\n            this.UseTemplateFunc()\n            this.setState({show: false})\n        }\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        if(this.state.show){\n            this.UseTemplateFunc()\n            this.setState({show: false})\n        }\n    }\n\n    wordFinder(word){\n        let start = null\n        let st = 0\n        if(word.includes(\"{\") && word.includes(\"}\")) {\n            for (let i = 0; i < word.length; i++) {\n                if (word[0] !== \"{\"){\n                    this.wordsForCheck.forEach(element => {\n                        if(this.state.variables[element] === \"\"){\n                            this.arr.push(\"{\" + element + \"}\")\n                        }\n                        else {\n                            this.arr.push(this.state.variables[element])\n                        }\n                    })\n                    this.wordsForCheck = []\n                }\n                if (word[i] === \"{\") {\n                    start = i\n                    if (st !== null){\n                        this.arr.push(word.replace(word.slice(i, word.length), \"\"))\n                        word = word.replace(word.slice(st, i), \"\")\n                        st = null\n                        if (start !== null){\n                            start = 0\n                        }\n                    }\n                }\n                else if (word[i] === \"}\") {\n                    if (start !== null) {\n                        if (this.state.variables[word.slice(start + 1, i)] !== undefined) {\n                            this.wordsForCheck.splice(0, 0, word.slice(start + 1, i))\n                        }\n                            let newWord = word.replace(word.slice(start, i + 1), \"\")\n                            this.wordFinder(newWord)\n                            return\n\n                    }\n                }\n            }\n        }\n        else {\n            this.wordsForCheck.forEach(element => {\n                if(this.state.variables[element] === \"\"){\n                    this.arr.push(\"{\" + element + \"}\")\n                }\n                else {\n                    this.arr.push(this.state.variables[element])\n                }\n            })\n            this.wordsForCheck = []\n            this.arr.push(word)\n        }\n    }\n\n    textGenerator(){\n        const text = this.state.txt.split(\" \")\n        for(let i = 1; i <= text.length; i+=2){\n            text.splice(i, 0, \" \")\n        }\n        text.forEach(word => {\n            this.wordFinder(word, [])\n        })\n    }\n\n    check(checkbox, variable){\n        if (checkbox.checked){\n            const div = document.getElementById(\"d\" + checkbox.id)\n            for (let i = 2; i <= this.state.recCount; i++) {\n                if (!document.getElementById(\"v\" + checkbox.id + \"dv\" + i)) {\n                    const label = document.createElement(\"label\")\n                    const input = document.createElement(\"input\")\n                    const newDiv = document.createElement(\"div\")\n                    input.id = \"t\" + checkbox.id + \"_\" + i\n                    input.onchange = (e) => {\n                        this.varsIndividual[variable][i-1] = e.target.value || \"{\" + variable + \"}\"\n                    }\n                    label.innerHTML = variable\n                    label.htmlFor = \"t\" + checkbox.id + \"_\" + i\n                    newDiv.id = \"v\" + checkbox.id + \"dv\" + i\n                    newDiv.appendChild(label)\n                    newDiv.appendChild(input)\n                    div.appendChild(newDiv)\n                }\n            }\n            const extraDiv = document.getElementById(\"v\" + checkbox.id + \"dv\" + (this.state.recCount + 1))\n            if (extraDiv) extraDiv.parentNode.removeChild(extraDiv)\n        }\n        else {\n            for (let i = 2; i <= this.state.recCount; i++){\n                const div = document.getElementById(\"v\" + checkbox.id + \"dv\" + i)\n                if(div) div.parentNode.removeChild(div)\n            }\n            this.varsIndividual[variable] = [this.varsIndividual[variable][0]]\n        }\n        console.log(this.varsIndividual)\n    }\n\n    async UseTemplateFunc(){\n        const div = document.getElementById(\"forVars\")\n        await this.vars.forEach(v => {\n            const copy = Object.assign(this.state.variables, {[v.varName]: \"{\" + [v.varName] + \"}\"})\n            const copy2 = Object.assign(this.varsIndividual, {[v.varName]: [\"{\" + [v.varName] + \"}\"]})\n            this.varsIndividual = copy2\n            this.setState({variables : copy})\n        })\n        await this.vars.forEach((template, index) => {\n            div.style.borderStyle = \"groove\"\n            div.style.borderColor = \"black\"\n            div.style.paddingTop = \"10px\"\n            div.style.paddingBottom = \"10px\"\n            div.style.paddingLeft = \"10px\"\n            const label = document.createElement(\"label\")\n            const input = document.createElement(\"input\")\n            const newDiv = document.createElement(\"div\")\n            const check = document.createElement(\"input\")\n            newDiv.id = \"d\" + (index + 1)\n            newDiv.className = \"checkDivs\"\n            check.className = \"checkbox\"\n            check.type = \"checkbox\"\n            check.id = index + 1\n            input.id = \"t\" + (index + 1)\n            input.onchange = (e) => {\n                this.setState(prevState => ({\n                    variables : {\n                        ...prevState.variables,\n                        [template.varName] : e.target.value\n                    }\n                }))\n                this.varsIndividual[template.varName][0] = e.target.value || \"{\" + template.varName + \"}\"\n                this.textGenerator()\n                let txt = \"\"\n                this.arr.forEach(v => txt += v)\n                this.arr = []\n                this.setState({text: txt})\n            }\n            label.innerHTML = template.varName || \"{noname}\"\n            label.htmlFor = \"t\" + (index + 1)\n            check.onclick = (e) => this.check(e.target, label.innerHTML)\n            newDiv.appendChild(label)\n            newDiv.appendChild(input)\n            newDiv.appendChild(check)\n            div.appendChild(newDiv)\n        })\n        const div2= document.getElementById(\"addRecBigDiv\")\n        await this.state.recipients.forEach((rec, index) => {\n            if (index !== 0){\n                const input = document.createElement(\"input\")\n                const button = document.createElement(\"button\")\n                const div = document.createElement(\"div\")\n                input.value = rec\n                div.className = \"addRecDiv\"\n                div.style.display = \"flex\"\n                this.setState({recCount: this.state.recCount + 1})\n                input.id = \"to\" + this.state.recCount\n                button.innerHTML = \"X\"\n                input.style.display = \"flex\"\n                input.className = \"formInputRec\"\n                button.className = \"delButRec\"\n                button.type = \"button\"\n                button.onclick = () => {\n                    input.parentNode.removeChild(input)\n                    button.style.display = \"none\"\n                }\n                div.appendChild(input)\n                div.appendChild(button)\n                div2.appendChild(div)\n            }\n        })\n    }\n\n    async sendMail(){\n        const from = document.getElementById(\"from\").value\n        let to = \"\"\n        for (let i = 1; i <= this.state.recCount; i++){\n            const rec = document.getElementById(\"to\" + i).value\n            to += rec\n            if (i !== this.state.recCount){\n                to += \",\"\n            }\n        }\n        const title = document.getElementById(\"title\").value\n        const text = document.getElementById(\"text\").value\n        await fetch(\"/useTemplate/send\", {\n            method:'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({\n                user: \"gorsimonyan200307@gmail.com\",\n                pass: \"gor07072003\",\n                from: from,\n                to: to,\n                subject: title,\n                text: text\n            })\n        })\n            .then(res => res.text())\n            .then(res => this.setState({apiResponse: res}))\n    }\n\n    async addRecipient(){\n        const input = document.createElement(\"input\")\n        const delButton = document.createElement(\"button\")\n        const div = document.createElement(\"div\")\n        await this.setState({recCount : this.state.recCount + 1})\n        for (let i = 1; i <= this.vars.length; i++){\n            const checkbox = document.getElementById(i)\n            this.check(checkbox, Object.keys(this.varsIndividual)[i-1])\n        }\n        div.style.display =\"flex\"\n        div.className = \"addRecDiv\"\n        input.id = \"recipients\" + this.state.recCount\n        input.style.display = \"flex\"\n        input.className = \"formInputRec\"\n        delButton.className = \"delButRec\"\n        delButton.type = \"button\"\n        delButton.id = \"del\" + this.state.recCount\n        delButton.innerHTML = \"X\"\n        delButton.onclick = async () => {\n            input.parentNode.removeChild(input)\n            delButton.style.display = \"none\"\n            await this.setState({recCount : this.state.recCount - 1})\n            for (let i = 1; i <= this.vars.length; i++){\n                const checkbox = document.getElementById(i)\n                this.check(checkbox, Object.keys(this.varsIndividual)[0])\n            }\n        }\n        const bigDiv = document.getElementById(\"addRecBigDiv\")\n        div.appendChild(input)\n        div.appendChild(delButton)\n        bigDiv.appendChild(div)\n    }\n\n    render() {\n        return (\n            <div style={{\"width\" : \"100%\"}}>\n                <Link to=\"/\">\n                    <button id={\"back\"}>Back</button>\n                </Link>\n                <div  id={\"sendBox\"}>\n                    <form id={\"sendForm\"} onSubmit={e => {\n                        e.preventDefault()\n                        window.history.replaceState(null, '', \"/\")\n                    }}>\n                        <div>\n                            <label htmlFor=\"from\" className=\"form\">from</label>\n                            <input id={\"from\"} type=\"email\" className=\"form\" value={this.state.template.templateFrom} onChange={(e) => {this.setState(prevState => ({\n                                template : {\n                                    ...prevState.template,\n                                    templateFrom : e.target.value\n                                }\n                            }))}}/>\n                        </div>\n                        <div>\n                            <label htmlFor={\"to\"} className=\"form\">To</label>\n                            <input id={\"to1\"} type=\"email\" className=\"form\" value={this.state.recipients[0]} onChange={(e) => {this.setState(prevState => ({\n                                recipients: {\n                                    ...prevState.recipients,\n                                    [0]: e.target.value\n                                }\n                            }))}}/>\n                            <button type={\"button\"} id={\"addRec\"} onClick={() => this.addRecipient()}>Add Recipient</button>\n                        </div>\n                        <div id={\"addRecBigDiv\"}>\n\n                        </div>\n                        <div>\n                            <label id={\"titleLabel\"} htmlFor={\"title\"} className=\"form\">title</label>\n                            <input id={\"title\"} className=\"form\" value={this.state.template.templateTitle} onChange={(e) => {this.setState(prevState => ({\n                                template : {\n                                    ...prevState.template,\n                                    templateTitle : e.target.value\n                                }\n                            }))}}/>\n                        </div>\n                        <div id={\"forVars\"}>\n\n                        </div>\n                        <div>\n                            <label htmlFor={\"text\"} className={\"form\"} id={\"textLabel\"}>Text</label>\n                            <textarea id={\"text\"} value={this.state.text} className={\"form\"} onChange={(e) => this.setState({text: e.target.value, txt: e.target.value})}/>\n                        </div>\n                        <Link to={\"/\"}>\n                            <button id={\"submit\"} type={\"submit\"} className={\"form\"} onClick={this.sendMail}>Send</button>\n                        </Link>\n                    </form>\n                </div>\n            </div>\n        )\n    }\n}\n\nexport default SendTemplate"]},"metadata":{},"sourceType":"module"}