{"ast":null,"code":"var _jsxFileName = \"/home/gor/Project/Email_tamplate/react_proj/src/Components/sendTemplate.js\";\nimport React, { Component } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass SendTemplate extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      text: \"\",\n      variables: {},\n      template: props.template\n    };\n    this.txt = \"\";\n    this.wordsForCheck = [];\n    this.arr = [];\n    this.recipients = props.recipients;\n    this.vars = props.vars;\n    this.UseTemplateFunc = this.UseTemplateFunc.bind(this);\n    this.sendMail = this.sendMail.bind(this);\n    this.textGenerator = this.textGenerator.bind(this);\n    this.wordFinder = this.wordFinder.bind(this);\n  }\n\n  wordFinder(word) {\n    let start = null;\n    let st = 0;\n\n    if (word.includes(\"{\") && word.includes(\"}\")) {\n      for (let i = 0; i < word.length; i++) {\n        if (word[0] !== \"{\") {\n          this.wordsForCheck.forEach(element => {\n            if (this.state.variables[element] === \"\") {\n              this.arr.push(\"{\" + element + \"}\");\n            } else {\n              this.arr.push(this.state.variables[element]);\n            }\n          });\n          this.wordsForCheck = [];\n        }\n\n        if (word[i] === \"{\") {\n          start = i;\n\n          if (st !== null) {\n            this.arr.push(word.replace(word.slice(i, word.length), \"\"));\n            word = word.replace(word.slice(st, i), \"\");\n            st = null;\n\n            if (start !== null) {\n              start = 0;\n            }\n          }\n        } else if (word[i] === \"}\") {\n          if (start !== null) {\n            this.wordsForCheck.splice(0, 0, word.slice(start + 1, i));\n            let newWord = word.replace(word.slice(start, i + 1), \"\");\n            this.wordFinder(newWord);\n            return;\n          }\n        }\n      }\n    } else {\n      this.wordsForCheck.forEach(element => {\n        if (this.state.variables[element] === \"\") {\n          this.arr.push(\"{\" + element + \"}\");\n        } else {\n          this.arr.push(this.state.variables[element]);\n        }\n      });\n      this.wordsForCheck = [];\n      this.arr.push(word);\n    }\n  }\n\n  textGenerator() {\n    const text = this.txt.split(\" \");\n\n    for (let i = 1; i <= text.length; i += 2) {\n      text.splice(i, 0, \" \");\n    }\n\n    text.forEach(word => {\n      this.wordFinder(word, []);\n    });\n  }\n\n  async UseTemplateFunc() {\n    const form = document.getElementById(\"sendForm\");\n    const from = document.getElementById(\"from\");\n    const to = document.getElementById(\"to\");\n    const title = document.getElementById(\"title\");\n    const textLabel = document.getElementById(\"textLabel\");\n    const template = this.words.filter(temp => temp.id == this.state.templateId)[0];\n    this.txt = template.templateText;\n    this.setState({\n      send: true,\n      text: this.txt\n    });\n    const recipients = this.recipients.filter(temp => temp.tableId == this.state.templateId);\n    const vars = this.vars.filter(temp => temp.tableId == this.state.templateId);\n    await vars.forEach(v => {\n      const copy = Object.assign(this.state.variables, {\n        [v.varName]: \"{\" + [v.varName] + \"}\"\n      });\n      this.setState({\n        variables: copy\n      });\n    });\n    await vars.forEach((template, index) => {\n      const label = document.createElement(\"label\");\n      const input = document.createElement(\"input\");\n      input.id = \"t\" + (index + 1);\n\n      input.onchange = e => {\n        this.setState(prevState => ({\n          variables: { ...prevState.variables,\n            [template.varName]: e.target.value\n          }\n        }));\n        this.textGenerator();\n        let txt = \"\";\n        this.arr.forEach(v => txt += v);\n        this.arr = [];\n        this.setState({\n          text: txt\n        });\n      };\n\n      label.innerHTML = template.varName;\n      label.htmlFor = \"t\" + (index + 1);\n      label.style.display = \"block\";\n      form.appendChild(label);\n      form.appendChild(input);\n      form.insertBefore(input, textLabel);\n      form.insertBefore(label, input);\n    });\n    from.value = template.templateFrom;\n    recipients.forEach(recipient => to.value += recipient.email);\n    title.value = template.templateTitle;\n  }\n\n  sendMail() {\n    const from = document.getElementById(\"from\").value;\n    const to = document.getElementById(\"to\").value;\n    const title = document.getElementById(\"title\").value;\n    const text = document.getElementById(\"text\").value;\n    fetch(\"/useTemplate/send\", {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        user: \"gorsimonyan200307@gmail.com\",\n        pass: \"gor07072003\",\n        from: from,\n        to: to,\n        subject: title,\n        text: text\n      })\n    }).then(res => res.text()).then(res => this.setState({\n      apiResponse: res\n    }));\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        id: \"sendForm\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"from\",\n          className: \"form\",\n          children: \"from\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"from\",\n          type: \"email\",\n          className: \"form\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"to\",\n          className: \"form\",\n          children: \"To\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"to\",\n          type: \"email\",\n          className: \"form\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"title\",\n          className: \"form\",\n          children: \"title\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"title\",\n          className: \"form\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"text\",\n          className: \"form\",\n          id: \"textLabel\",\n          children: \"Text\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"text\",\n          value: this.state.text,\n          className: \"form\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          id: \"submit\",\n          type: \"submit\",\n          className: \"form\",\n          onClick: this.sendMail,\n          children: \"Send\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default SendTemplate;","map":{"version":3,"sources":["/home/gor/Project/Email_tamplate/react_proj/src/Components/sendTemplate.js"],"names":["React","Component","SendTemplate","constructor","props","state","text","variables","template","txt","wordsForCheck","arr","recipients","vars","UseTemplateFunc","bind","sendMail","textGenerator","wordFinder","word","start","st","includes","i","length","forEach","element","push","replace","slice","splice","newWord","split","form","document","getElementById","from","to","title","textLabel","words","filter","temp","id","templateId","templateText","setState","send","tableId","v","copy","Object","assign","varName","index","label","createElement","input","onchange","e","prevState","target","value","innerHTML","htmlFor","style","display","appendChild","insertBefore","templateFrom","recipient","email","templateTitle","fetch","method","headers","body","JSON","stringify","user","pass","subject","then","res","apiResponse","render"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;;;AAEA,MAAMC,YAAN,SAA2BD,SAA3B,CAAoC;AAChCE,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACf,UAAMA,KAAN;AACA,SAAKC,KAAL,GAAW;AACPC,MAAAA,IAAI,EAAE,EADC;AAEPC,MAAAA,SAAS,EAAE,EAFJ;AAGPC,MAAAA,QAAQ,EAAEJ,KAAK,CAACI;AAHT,KAAX;AAKA,SAAKC,GAAL,GAAW,EAAX;AACA,SAAKC,aAAL,GAAqB,EAArB;AACA,SAAKC,GAAL,GAAW,EAAX;AACA,SAAKC,UAAL,GAAkBR,KAAK,CAACQ,UAAxB;AACA,SAAKC,IAAL,GAAYT,KAAK,CAACS,IAAlB;AACA,SAAKC,eAAL,GAAuB,KAAKA,eAAL,CAAqBC,IAArB,CAA0B,IAA1B,CAAvB;AACA,SAAKC,QAAL,GAAgB,KAAKA,QAAL,CAAcD,IAAd,CAAmB,IAAnB,CAAhB;AACA,SAAKE,aAAL,GAAqB,KAAKA,aAAL,CAAmBF,IAAnB,CAAwB,IAAxB,CAArB;AACA,SAAKG,UAAL,GAAkB,KAAKA,UAAL,CAAgBH,IAAhB,CAAqB,IAArB,CAAlB;AACH;;AAEDG,EAAAA,UAAU,CAACC,IAAD,EAAM;AACZ,QAAIC,KAAK,GAAG,IAAZ;AACA,QAAIC,EAAE,GAAG,CAAT;;AACA,QAAGF,IAAI,CAACG,QAAL,CAAc,GAAd,KAAsBH,IAAI,CAACG,QAAL,CAAc,GAAd,CAAzB,EAA6C;AACzC,WAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGJ,IAAI,CAACK,MAAzB,EAAiCD,CAAC,EAAlC,EAAsC;AAClC,YAAIJ,IAAI,CAAC,CAAD,CAAJ,KAAY,GAAhB,EAAoB;AAChB,eAAKT,aAAL,CAAmBe,OAAnB,CAA2BC,OAAO,IAAI;AAClC,gBAAG,KAAKrB,KAAL,CAAWE,SAAX,CAAqBmB,OAArB,MAAkC,EAArC,EAAwC;AACpC,mBAAKf,GAAL,CAASgB,IAAT,CAAc,MAAMD,OAAN,GAAgB,GAA9B;AACH,aAFD,MAGK;AACD,mBAAKf,GAAL,CAASgB,IAAT,CAAc,KAAKtB,KAAL,CAAWE,SAAX,CAAqBmB,OAArB,CAAd;AACH;AACJ,WAPD;AAQA,eAAKhB,aAAL,GAAqB,EAArB;AACH;;AACD,YAAIS,IAAI,CAACI,CAAD,CAAJ,KAAY,GAAhB,EAAqB;AACjBH,UAAAA,KAAK,GAAGG,CAAR;;AACA,cAAIF,EAAE,KAAK,IAAX,EAAgB;AACZ,iBAAKV,GAAL,CAASgB,IAAT,CAAcR,IAAI,CAACS,OAAL,CAAaT,IAAI,CAACU,KAAL,CAAWN,CAAX,EAAcJ,IAAI,CAACK,MAAnB,CAAb,EAAyC,EAAzC,CAAd;AACAL,YAAAA,IAAI,GAAGA,IAAI,CAACS,OAAL,CAAaT,IAAI,CAACU,KAAL,CAAWR,EAAX,EAAeE,CAAf,CAAb,EAAgC,EAAhC,CAAP;AACAF,YAAAA,EAAE,GAAG,IAAL;;AACA,gBAAID,KAAK,KAAK,IAAd,EAAmB;AACfA,cAAAA,KAAK,GAAG,CAAR;AACH;AACJ;AACJ,SAVD,MAWK,IAAID,IAAI,CAACI,CAAD,CAAJ,KAAY,GAAhB,EAAqB;AACtB,cAAIH,KAAK,KAAK,IAAd,EAAoB;AAChB,iBAAKV,aAAL,CAAmBoB,MAAnB,CAA0B,CAA1B,EAA6B,CAA7B,EAAgCX,IAAI,CAACU,KAAL,CAAWT,KAAK,GAAG,CAAnB,EAAsBG,CAAtB,CAAhC;AACA,gBAAIQ,OAAO,GAAGZ,IAAI,CAACS,OAAL,CAAaT,IAAI,CAACU,KAAL,CAAWT,KAAX,EAAkBG,CAAC,GAAG,CAAtB,CAAb,EAAuC,EAAvC,CAAd;AACA,iBAAKL,UAAL,CAAgBa,OAAhB;AACA;AACH;AACJ;AACJ;AACJ,KAjCD,MAkCK;AACD,WAAKrB,aAAL,CAAmBe,OAAnB,CAA2BC,OAAO,IAAI;AAClC,YAAG,KAAKrB,KAAL,CAAWE,SAAX,CAAqBmB,OAArB,MAAkC,EAArC,EAAwC;AACpC,eAAKf,GAAL,CAASgB,IAAT,CAAc,MAAMD,OAAN,GAAgB,GAA9B;AACH,SAFD,MAGK;AACD,eAAKf,GAAL,CAASgB,IAAT,CAAc,KAAKtB,KAAL,CAAWE,SAAX,CAAqBmB,OAArB,CAAd;AACH;AACJ,OAPD;AAQA,WAAKhB,aAAL,GAAqB,EAArB;AACA,WAAKC,GAAL,CAASgB,IAAT,CAAcR,IAAd;AACH;AACJ;;AAEDF,EAAAA,aAAa,GAAE;AACX,UAAMX,IAAI,GAAG,KAAKG,GAAL,CAASuB,KAAT,CAAe,GAAf,CAAb;;AACA,SAAI,IAAIT,CAAC,GAAG,CAAZ,EAAeA,CAAC,IAAIjB,IAAI,CAACkB,MAAzB,EAAiCD,CAAC,IAAE,CAApC,EAAsC;AAClCjB,MAAAA,IAAI,CAACwB,MAAL,CAAYP,CAAZ,EAAe,CAAf,EAAkB,GAAlB;AACH;;AACDjB,IAAAA,IAAI,CAACmB,OAAL,CAAaN,IAAI,IAAI;AACjB,WAAKD,UAAL,CAAgBC,IAAhB,EAAsB,EAAtB;AACH,KAFD;AAGH;;AAEoB,QAAfL,eAAe,GAAE;AACnB,UAAMmB,IAAI,GAAGC,QAAQ,CAACC,cAAT,CAAwB,UAAxB,CAAb;AACA,UAAMC,IAAI,GAAGF,QAAQ,CAACC,cAAT,CAAwB,MAAxB,CAAb;AACA,UAAME,EAAE,GAAGH,QAAQ,CAACC,cAAT,CAAwB,IAAxB,CAAX;AACA,UAAMG,KAAK,GAAGJ,QAAQ,CAACC,cAAT,CAAwB,OAAxB,CAAd;AACA,UAAMI,SAAS,GAAGL,QAAQ,CAACC,cAAT,CAAwB,WAAxB,CAAlB;AACA,UAAM3B,QAAQ,GAAI,KAAKgC,KAAL,CAAWC,MAAX,CAAkBC,IAAI,IAAIA,IAAI,CAACC,EAAL,IAAW,KAAKtC,KAAL,CAAWuC,UAAhD,CAAD,CAA8D,CAA9D,CAAjB;AACA,SAAKnC,GAAL,GAAWD,QAAQ,CAACqC,YAApB;AACA,SAAKC,QAAL,CAAc;AAACC,MAAAA,IAAI,EAAE,IAAP;AAAazC,MAAAA,IAAI,EAAE,KAAKG;AAAxB,KAAd;AACA,UAAMG,UAAU,GAAG,KAAKA,UAAL,CAAgB6B,MAAhB,CAAuBC,IAAI,IAAIA,IAAI,CAACM,OAAL,IAAgB,KAAK3C,KAAL,CAAWuC,UAA1D,CAAnB;AACA,UAAM/B,IAAI,GAAG,KAAKA,IAAL,CAAU4B,MAAV,CAAiBC,IAAI,IAAIA,IAAI,CAACM,OAAL,IAAgB,KAAK3C,KAAL,CAAWuC,UAApD,CAAb;AACA,UAAM/B,IAAI,CAACY,OAAL,CAAawB,CAAC,IAAI;AACpB,YAAMC,IAAI,GAAGC,MAAM,CAACC,MAAP,CAAc,KAAK/C,KAAL,CAAWE,SAAzB,EAAoC;AAAC,SAAC0C,CAAC,CAACI,OAAH,GAAa,MAAM,CAACJ,CAAC,CAACI,OAAH,CAAN,GAAoB;AAAlC,OAApC,CAAb;AACA,WAAKP,QAAL,CAAc;AAACvC,QAAAA,SAAS,EAAG2C;AAAb,OAAd;AACH,KAHK,CAAN;AAIA,UAAMrC,IAAI,CAACY,OAAL,CAAa,CAACjB,QAAD,EAAW8C,KAAX,KAAqB;AACpC,YAAMC,KAAK,GAAGrB,QAAQ,CAACsB,aAAT,CAAuB,OAAvB,CAAd;AACA,YAAMC,KAAK,GAAGvB,QAAQ,CAACsB,aAAT,CAAuB,OAAvB,CAAd;AACAC,MAAAA,KAAK,CAACd,EAAN,GAAW,OAAOW,KAAK,GAAG,CAAf,CAAX;;AACAG,MAAAA,KAAK,CAACC,QAAN,GAAkBC,CAAD,IAAO;AACpB,aAAKb,QAAL,CAAcc,SAAS,KAAK;AACxBrD,UAAAA,SAAS,EAAG,EACR,GAAGqD,SAAS,CAACrD,SADL;AAER,aAACC,QAAQ,CAAC6C,OAAV,GAAqBM,CAAC,CAACE,MAAF,CAASC;AAFtB;AADY,SAAL,CAAvB;AAMA,aAAK7C,aAAL;AACA,YAAIR,GAAG,GAAG,EAAV;AACA,aAAKE,GAAL,CAASc,OAAT,CAAiBwB,CAAC,IAAIxC,GAAG,IAAIwC,CAA7B;AACA,aAAKtC,GAAL,GAAW,EAAX;AACA,aAAKmC,QAAL,CAAc;AAACxC,UAAAA,IAAI,EAAEG;AAAP,SAAd;AACH,OAZD;;AAaA8C,MAAAA,KAAK,CAACQ,SAAN,GAAkBvD,QAAQ,CAAC6C,OAA3B;AACAE,MAAAA,KAAK,CAACS,OAAN,GAAgB,OAAOV,KAAK,GAAG,CAAf,CAAhB;AACAC,MAAAA,KAAK,CAACU,KAAN,CAAYC,OAAZ,GAAsB,OAAtB;AACAjC,MAAAA,IAAI,CAACkC,WAAL,CAAiBZ,KAAjB;AACAtB,MAAAA,IAAI,CAACkC,WAAL,CAAiBV,KAAjB;AACAxB,MAAAA,IAAI,CAACmC,YAAL,CAAkBX,KAAlB,EAAyBlB,SAAzB;AACAN,MAAAA,IAAI,CAACmC,YAAL,CAAkBb,KAAlB,EAAyBE,KAAzB;AACH,KAxBK,CAAN;AAyBArB,IAAAA,IAAI,CAAC0B,KAAL,GAAatD,QAAQ,CAAC6D,YAAtB;AACAzD,IAAAA,UAAU,CAACa,OAAX,CAAmB6C,SAAS,IAAIjC,EAAE,CAACyB,KAAH,IAAYQ,SAAS,CAACC,KAAtD;AACAjC,IAAAA,KAAK,CAACwB,KAAN,GAActD,QAAQ,CAACgE,aAAvB;AACH;;AAEDxD,EAAAA,QAAQ,GAAE;AACN,UAAMoB,IAAI,GAAGF,QAAQ,CAACC,cAAT,CAAwB,MAAxB,EAAgC2B,KAA7C;AACA,UAAMzB,EAAE,GAAGH,QAAQ,CAACC,cAAT,CAAwB,IAAxB,EAA8B2B,KAAzC;AACA,UAAMxB,KAAK,GAAGJ,QAAQ,CAACC,cAAT,CAAwB,OAAxB,EAAiC2B,KAA/C;AACA,UAAMxD,IAAI,GAAG4B,QAAQ,CAACC,cAAT,CAAwB,MAAxB,EAAgC2B,KAA7C;AACAW,IAAAA,KAAK,CAAC,mBAAD,EAAsB;AACvBC,MAAAA,MAAM,EAAC,MADgB;AAEvBC,MAAAA,OAAO,EAAE;AAAE,wBAAgB;AAAlB,OAFc;AAGvBC,MAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AACjBC,QAAAA,IAAI,EAAE,6BADW;AAEjBC,QAAAA,IAAI,EAAE,aAFW;AAGjB5C,QAAAA,IAAI,EAAEA,IAHW;AAIjBC,QAAAA,EAAE,EAAEA,EAJa;AAKjB4C,QAAAA,OAAO,EAAE3C,KALQ;AAMjBhC,QAAAA,IAAI,EAAEA;AANW,OAAf;AAHiB,KAAtB,CAAL,CAYK4E,IAZL,CAYUC,GAAG,IAAIA,GAAG,CAAC7E,IAAJ,EAZjB,EAaK4E,IAbL,CAaUC,GAAG,IAAI,KAAKrC,QAAL,CAAc;AAACsC,MAAAA,WAAW,EAAED;AAAd,KAAd,CAbjB;AAcH;;AAEDE,EAAAA,MAAM,GAAG;AACL,wBACI;AAAA,6BACI;AAAM,QAAA,EAAE,EAAE,UAAV;AAAA,gCACI;AAAO,UAAA,OAAO,EAAC,MAAf;AAAsB,UAAA,SAAS,EAAC,MAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADJ,eAEI;AAAO,UAAA,EAAE,EAAE,MAAX;AAAmB,UAAA,IAAI,EAAC,OAAxB;AAAgC,UAAA,SAAS,EAAC;AAA1C;AAAA;AAAA;AAAA;AAAA,gBAFJ,eAGI;AAAO,UAAA,OAAO,EAAE,IAAhB;AAAsB,UAAA,SAAS,EAAC,MAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAHJ,eAII;AAAO,UAAA,EAAE,EAAE,IAAX;AAAiB,UAAA,IAAI,EAAC,OAAtB;AAA8B,UAAA,SAAS,EAAC;AAAxC;AAAA;AAAA;AAAA;AAAA,gBAJJ,eAKI;AAAO,UAAA,OAAO,EAAE,OAAhB;AAAyB,UAAA,SAAS,EAAC,MAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBALJ,eAMI;AAAO,UAAA,EAAE,EAAE,OAAX;AAAoB,UAAA,SAAS,EAAC;AAA9B;AAAA;AAAA;AAAA;AAAA,gBANJ,eAOI;AAAO,UAAA,OAAO,EAAE,MAAhB;AAAwB,UAAA,SAAS,EAAE,MAAnC;AAA2C,UAAA,EAAE,EAAE,WAA/C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAPJ,eAQI;AAAO,UAAA,EAAE,EAAE,MAAX;AAAmB,UAAA,KAAK,EAAE,KAAKhF,KAAL,CAAWC,IAArC;AAA2C,UAAA,SAAS,EAAE;AAAtD;AAAA;AAAA;AAAA;AAAA,gBARJ,eASI;AAAQ,UAAA,EAAE,EAAE,QAAZ;AAAsB,UAAA,IAAI,EAAE,QAA5B;AAAsC,UAAA,SAAS,EAAE,MAAjD;AAAyD,UAAA,OAAO,EAAE,KAAKU,QAAvE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBATJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,YADJ;AAeH;;AAlK+B;;AAqKpC,eAAed,YAAf","sourcesContent":["import React, { Component } from \"react\"\n\nclass SendTemplate extends Component{\n    constructor(props) {\n        super(props);\n        this.state={\n            text: \"\",\n            variables: {},\n            template: props.template\n        }\n        this.txt = \"\"\n        this.wordsForCheck = []\n        this.arr = []\n        this.recipients = props.recipients\n        this.vars = props.vars\n        this.UseTemplateFunc = this.UseTemplateFunc.bind(this)\n        this.sendMail = this.sendMail.bind(this)\n        this.textGenerator = this.textGenerator.bind(this)\n        this.wordFinder = this.wordFinder.bind(this)\n    }\n\n    wordFinder(word){\n        let start = null\n        let st = 0\n        if(word.includes(\"{\") && word.includes(\"}\")) {\n            for (let i = 0; i < word.length; i++) {\n                if (word[0] !== \"{\"){\n                    this.wordsForCheck.forEach(element => {\n                        if(this.state.variables[element] === \"\"){\n                            this.arr.push(\"{\" + element + \"}\")\n                        }\n                        else {\n                            this.arr.push(this.state.variables[element])\n                        }\n                    })\n                    this.wordsForCheck = []\n                }\n                if (word[i] === \"{\") {\n                    start = i\n                    if (st !== null){\n                        this.arr.push(word.replace(word.slice(i, word.length), \"\"))\n                        word = word.replace(word.slice(st, i), \"\")\n                        st = null\n                        if (start !== null){\n                            start = 0\n                        }\n                    }\n                }\n                else if (word[i] === \"}\") {\n                    if (start !== null) {\n                        this.wordsForCheck.splice(0, 0, word.slice(start + 1, i))\n                        let newWord = word.replace(word.slice(start, i + 1), \"\")\n                        this.wordFinder(newWord)\n                        return\n                    }\n                }\n            }\n        }\n        else {\n            this.wordsForCheck.forEach(element => {\n                if(this.state.variables[element] === \"\"){\n                    this.arr.push(\"{\" + element + \"}\")\n                }\n                else {\n                    this.arr.push(this.state.variables[element])\n                }\n            })\n            this.wordsForCheck = []\n            this.arr.push(word)\n        }\n    }\n\n    textGenerator(){\n        const text = this.txt.split(\" \")\n        for(let i = 1; i <= text.length; i+=2){\n            text.splice(i, 0, \" \")\n        }\n        text.forEach(word => {\n            this.wordFinder(word, [])\n        })\n    }\n\n    async UseTemplateFunc(){\n        const form = document.getElementById(\"sendForm\")\n        const from = document.getElementById(\"from\")\n        const to = document.getElementById(\"to\")\n        const title = document.getElementById(\"title\")\n        const textLabel = document.getElementById(\"textLabel\")\n        const template = (this.words.filter(temp => temp.id == this.state.templateId))[0]\n        this.txt = template.templateText\n        this.setState({send: true, text: this.txt})\n        const recipients = this.recipients.filter(temp => temp.tableId == this.state.templateId)\n        const vars = this.vars.filter(temp => temp.tableId == this.state.templateId)\n        await vars.forEach(v => {\n            const copy = Object.assign(this.state.variables, {[v.varName]: \"{\" + [v.varName] + \"}\"})\n            this.setState({variables : copy})\n        })\n        await vars.forEach((template, index) => {\n            const label = document.createElement(\"label\")\n            const input = document.createElement(\"input\")\n            input.id = \"t\" + (index + 1)\n            input.onchange = (e) => {\n                this.setState(prevState => ({\n                    variables : {\n                        ...prevState.variables,\n                        [template.varName] : e.target.value\n                    }\n                }))\n                this.textGenerator()\n                let txt = \"\"\n                this.arr.forEach(v => txt += v)\n                this.arr = []\n                this.setState({text: txt})\n            }\n            label.innerHTML = template.varName\n            label.htmlFor = \"t\" + (index + 1)\n            label.style.display = \"block\"\n            form.appendChild(label)\n            form.appendChild(input)\n            form.insertBefore(input, textLabel)\n            form.insertBefore(label, input)\n        })\n        from.value = template.templateFrom\n        recipients.forEach(recipient => to.value += recipient.email)\n        title.value = template.templateTitle\n    }\n\n    sendMail(){\n        const from = document.getElementById(\"from\").value\n        const to = document.getElementById(\"to\").value\n        const title = document.getElementById(\"title\").value\n        const text = document.getElementById(\"text\").value\n        fetch(\"/useTemplate/send\", {\n            method:'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({\n                user: \"gorsimonyan200307@gmail.com\",\n                pass: \"gor07072003\",\n                from: from,\n                to: to,\n                subject: title,\n                text: text\n            })\n        })\n            .then(res => res.text())\n            .then(res => this.setState({apiResponse: res}))\n    }\n\n    render() {\n        return (\n            <div>\n                <form id={\"sendForm\"} >\n                    <label htmlFor=\"from\" className=\"form\">from</label>\n                    <input id={\"from\"} type=\"email\" className=\"form\"/>\n                    <label htmlFor={\"to\"} className=\"form\">To</label>\n                    <input id={\"to\"} type=\"email\" className=\"form\"/>\n                    <label htmlFor={\"title\"} className=\"form\">title</label>\n                    <input id={\"title\"} className=\"form\"/>\n                    <label htmlFor={\"text\"} className={\"form\"} id={\"textLabel\"}>Text</label>\n                    <input id={\"text\"} value={this.state.text} className={\"form\"}/>\n                    <button id={\"submit\"} type={\"submit\"} className={\"form\"} onClick={this.sendMail}>Send</button>\n                </form>\n            </div>\n        )\n    }\n}\n\nexport default SendTemplate"]},"metadata":{},"sourceType":"module"}